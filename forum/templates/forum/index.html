{% extends 'forum/base.html' %}
{% load static %}
{% block headcontent %}
	<link rel="stylesheet" href="{% static 'forum/style.css' %}">
{% endblock %}
{% block content %}
<main>
	<h1>FORUM</h1>
	
	{% if user.is_authenticated %}
		<a href="{% url 'forum:thread_create' %}" class="btn">Create New Thread</a>
		
		<section class="user-threads">
			<h2>Your Threads</h2>
			<ul>
				{% for thread in user_threads %}
				<li>
					<article class="post-heading">
						<a href="{% url 'forum:thread_detail' thread.id %}"><h2>{{ thread.title }}</h2></a>
						<p class="category-chip">{{ thread.category }}</p>
						<p class="sample-text">{{ thread.entry }}</p>
						<section class="date">
							<p>Created {{ thread.created_on | date }}. Last updated {{ thread.updated_on | date }}</p>
						</section>
					</article>
				</li>
				{% empty %}
				<li>No threads created by you.</li>
				{% endfor %}
			</ul>
		</section>
	{% endif %}
	
	<section class="post-list">
		<h2>All Threads</h2>
		{% for category in categories %}
			<h3>{{ category.name }}</h3>
			<ul>
				{% for thread in category.thread_set.all %}
					{% if not user.is_authenticated or thread.author != user.profile %}
					<li>
						<article class="post-heading">
							<a href="{% url 'forum:thread_detail' thread.id %}"><h2>{{ thread.title }}</h2></a>
							<p class="category-chip">{{ thread.category }}</p>
							<p class="sample-text">{{ thread.entry }}</p>
							<section class="date">
								<p>Created {{ thread.created_on | date }}. Last updated {{ thread.updated_on | date }}</p>
							</section>
						</article>
					</li>
					{% endif %}
				{% empty %}
				<li>No threads in this category.</li>
				{% endfor %}
			</ul>
		{% endfor %}
	</section>
</main>
{% endblock %}